<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>esql cheatsheet</title>
<link rel="stylesheet" href="../css/main.css?version=1756629064754"><link rel="stylesheet" href="../css/prism.css?version=1756629064754"></head>

<body>
    <script>
        if (!location.hostname.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/)
            && location.hostname !== 'localhost'
        ) {
            if (location.protocol === 'http:') {
                // https 跳转
                location.href = 'https:' + location.href.substring(window.location.protocol.length)
            } else if (location.pathname === '/') {
                // 静态跳转
                if ((/#\/[^/]+/).test(location.hash)) {
                    location.href = `https://${location.hostname}/docs/${location.hash.substring(2)}.html`
                } else {
                    location.href = `https://${location.hostname}/docs/`
                }
            }
        }
        let isHtml = true
    </script>

    <div id="loading" class="hide" data-cs-theme="light"></div>
    <div id="top-nav" data-cs-theme="light">
        <div class="top-nav__wrapper">
            <div id="go-back" onclick="history.go(-1)">返回</div>
            <a id="go-home" href="./index.html">首页</a>

        </div>
    </div>
    <div id="main">
        <div id="sheet-wrapper">
            <div id="sheet-title">
                <h1>ES|QL 语法速查表 (SQL vs ES|QL)<span> cheatsheet</span></h1>
            </div>
            <div id="sheet-body">
                
                <div class="h2-section" >
                    
                    
                            <div class="sheet-section"  data-position="580|0|0">
                                <div class="section-title"><h3 id="id-0">1. 数据源</h3></div>
                                <div class="section-body">
                                    <pre class="language-sql" tabindex="0"><code class="language-sql" style="font-size: 12px !important;"><span class="token operator">|</span> <span class="token keyword">SQL</span>                  <span class="token operator">|</span> ES \<span class="token operator">|</span> QL  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token comment">-------------------- | --------- |</span>
<span class="token operator">|</span> <span class="token keyword">SELECT</span> \<span class="token operator">*</span> <span class="token keyword">FROM</span> logs<span class="token punctuation">;</span> <span class="token operator">|</span> <span class="token keyword">FROM</span> logs <span class="token operator">|</span>
</code></pre>
                                </div>
                            </div>

                            <div class="sheet-section"  data-position="580|600|0">
                                <div class="section-title"><h3 id="id-1">2. 条件过滤</h3></div>
                                <div class="section-body">
                                    <pre class="language-sql" tabindex="0"><code class="language-sql" style="font-size: 12px !important;"><span class="token operator">|</span> <span class="token keyword">SQL</span>                                   <span class="token operator">|</span> ES \<span class="token operator">|</span> QL                                  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token comment">------------------------------------- | ----------------------------------------- |</span>
<span class="token operator">|</span> <span class="token keyword">WHERE</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token number">200</span>                    <span class="token operator">|</span> \<span class="token operator">|</span> <span class="token keyword">WHERE</span> <span class="token keyword">status</span> <span class="token operator">=</span><span class="token operator">=</span> <span class="token number">200</span>                    <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">WHERE</span> <span class="token keyword">status</span> <span class="token operator">!=</span> <span class="token number">404</span>                   <span class="token operator">|</span> \<span class="token operator">|</span> <span class="token keyword">WHERE</span> <span class="token keyword">status</span> <span class="token operator">!=</span> <span class="token number">404</span>                    <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">WHERE</span> <span class="token keyword">status</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">201</span><span class="token punctuation">)</span>            <span class="token operator">|</span> \<span class="token operator">|</span> <span class="token keyword">WHERE</span> <span class="token keyword">status</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">201</span><span class="token punctuation">)</span>             <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">WHERE</span> latency <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token operator">AND</span> host <span class="token operator">=</span> <span class="token string">'web1'</span> <span class="token operator">|</span> \<span class="token operator">|</span> <span class="token keyword">WHERE</span> latency <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token operator">AND</span> host <span class="token operator">=</span><span class="token operator">=</span> <span class="token string">"web1"</span> <span class="token operator">|</span>
</code></pre>
                                </div>
                            </div>

                            <div class="sheet-section"  data-position="580|0|152">
                                <div class="section-title"><h3 id="id-2">3. 字段选择</h3></div>
                                <div class="section-body">
                                    <pre class="language-sql" tabindex="0"><code class="language-sql" style="font-size: 12px !important;"><span class="token operator">|</span> <span class="token keyword">SQL</span>                                 <span class="token operator">|</span> ES \<span class="token operator">|</span> QL                        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token comment">----------------------------------- | ------------------------------- |</span>
<span class="token operator">|</span> <span class="token keyword">SELECT</span> host<span class="token punctuation">,</span> latency <span class="token keyword">FROM</span> logs<span class="token punctuation">;</span>     <span class="token operator">|</span> <span class="token keyword">FROM</span> logs \<span class="token operator">|</span> KEEP host<span class="token punctuation">,</span> latency <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">SELECT</span> \<span class="token operator">*</span> <span class="token keyword">EXCEPT</span> latency <span class="token keyword">FROM</span> logs<span class="token punctuation">;</span> <span class="token operator">|</span> <span class="token keyword">FROM</span> logs \<span class="token operator">|</span> <span class="token keyword">DROP</span> latency       <span class="token operator">|</span>
</code></pre>
                                </div>
                            </div>

                            <div class="sheet-section"  data-position="580|600|220">
                                <div class="section-title"><h3 id="id-3">4. 计算字段</h3></div>
                                <div class="section-body">
                                    <pre class="language-sql" tabindex="0"><code class="language-sql" style="font-size: 12px !important;"><span class="token operator">|</span> <span class="token keyword">SQL</span>                                           <span class="token operator">|</span> ES \<span class="token operator">|</span> QL                                          <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token comment">--------------------------------------------- | ------------------------------------------------- |</span>
<span class="token operator">|</span> <span class="token keyword">SELECT</span> latency<span class="token operator">/</span><span class="token number">1000</span> <span class="token keyword">AS</span> latency_sec <span class="token keyword">FROM</span> logs<span class="token punctuation">;</span> <span class="token operator">|</span> <span class="token keyword">FROM</span> logs \<span class="token operator">|</span> EVAL latency_sec <span class="token operator">=</span> latency <span class="token operator">/</span> <span class="token number">1000</span>    <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span>host<span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">,</span> <span class="token keyword">status</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> logs<span class="token punctuation">;</span>   <span class="token operator">|</span> <span class="token keyword">FROM</span> logs \<span class="token operator">|</span> EVAL tag <span class="token operator">=</span> CONCAT<span class="token punctuation">(</span>host<span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token keyword">status</span><span class="token punctuation">)</span> <span class="token operator">|</span>
</code></pre>
                                </div>
                            </div>

                            <div class="sheet-section"  data-position="580|0|324">
                                <div class="section-title"><h3 id="id-4">5. 聚合统计</h3></div>
                                <div class="section-body">
                                    <pre class="language-sql" tabindex="0"><code class="language-sql" style="font-size: 12px !important;"><span class="token operator">|</span> <span class="token keyword">SQL</span>                                                <span class="token operator">|</span> ES \<span class="token operator">|</span> QL                                              <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token comment">-------------------------------------------------- | ----------------------------------------------------- |</span>
<span class="token operator">|</span> <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>\<span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> logs<span class="token punctuation">;</span>                        <span class="token operator">|</span> <span class="token keyword">FROM</span> logs \<span class="token operator">|</span> STATS <span class="token function">COUNT</span><span class="token punctuation">(</span>\<span class="token operator">*</span><span class="token punctuation">)</span>                          <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">SELECT</span> host<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>\<span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> logs <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> host<span class="token punctuation">;</span>    <span class="token operator">|</span> <span class="token keyword">FROM</span> logs \<span class="token operator">|</span> STATS <span class="token function">COUNT</span><span class="token punctuation">(</span>\<span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">BY</span> host                  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">SELECT</span> host<span class="token punctuation">,</span> <span class="token function">AVG</span><span class="token punctuation">(</span>latency<span class="token punctuation">)</span> <span class="token keyword">FROM</span> logs <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> host<span class="token punctuation">;</span> <span class="token operator">|</span> <span class="token keyword">FROM</span> logs \<span class="token operator">|</span> STATS avg_latency <span class="token operator">=</span> <span class="token function">AVG</span><span class="token punctuation">(</span>latency<span class="token punctuation">)</span> <span class="token keyword">BY</span> host <span class="token operator">|</span>
</code></pre>
                                </div>
                            </div>

                            <div class="sheet-section"  data-position="580|600|400">
                                <div class="section-title"><h3 id="id-5">6. 排序 &amp; 限制</h3></div>
                                <div class="section-body">
                                    <pre class="language-sql" tabindex="0"><code class="language-sql" style="font-size: 12px !important;"><span class="token operator">|</span> <span class="token keyword">SQL</span>                       <span class="token operator">|</span> ES \<span class="token operator">|</span> QL                 <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token comment">------------------------- | ------------------------ |</span>
<span class="token operator">|</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> avg_latency <span class="token keyword">DESC</span> <span class="token operator">|</span> \<span class="token operator">|</span> SORT avg_latency <span class="token keyword">DESC</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">LIMIT</span> <span class="token number">10</span>                  <span class="token operator">|</span> \<span class="token operator">|</span> <span class="token keyword">LIMIT</span> <span class="token number">10</span>              <span class="token operator">|</span>
</code></pre>
                                </div>
                            </div>

                            <div class="sheet-section"  data-position="580|0|524">
                                <div class="section-title"><h3 id="id-6">7. 时间函数</h3></div>
                                <div class="section-body">
                                    <pre class="language-sql" tabindex="0"><code class="language-sql" style="font-size: 12px !important;"><span class="token operator">|</span> <span class="token keyword">SQL</span>                                     <span class="token operator">|</span> ES \<span class="token operator">|</span> QL                                           <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token comment">--------------------------------------- | -------------------------------------------------- |</span>
<span class="token operator">|</span> <span class="token keyword">SELECT</span> DATE_TRUNC<span class="token punctuation">(</span><span class="token string">'day'</span><span class="token punctuation">,</span> ts<span class="token punctuation">)</span> <span class="token keyword">FROM</span> logs<span class="token punctuation">;</span> <span class="token operator">|</span> <span class="token keyword">FROM</span> logs \<span class="token operator">|</span> EVAL <span class="token keyword">day</span> <span class="token operator">=</span> DATE_TRUNC<span class="token punctuation">(</span><span class="token number">1</span>d<span class="token punctuation">,</span> <span class="token variable">@timestamp</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">SELECT</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                           <span class="token operator">|</span> <span class="token keyword">FROM</span> logs \<span class="token operator">|</span> EVAL now <span class="token operator">=</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                      <span class="token operator">|</span>
</code></pre>
                                </div>
                            </div>

                            <div class="sheet-section"  data-position="580|600|572">
                                <div class="section-title"><h3 id="id-7">8. 常见函数</h3></div>
                                <div class="section-body">
                                    <pre class="language-sql" tabindex="0"><code class="language-sql" style="font-size: 12px !important;"><span class="token operator">|</span> 类型   <span class="token operator">|</span> <span class="token keyword">SQL</span>            <span class="token operator">|</span> ES \<span class="token operator">|</span> QL       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token comment">------ | -------------- | -------------- |</span>
<span class="token operator">|</span> 字符串 <span class="token operator">|</span> UPPER<span class="token punctuation">(</span>host<span class="token punctuation">)</span>    <span class="token operator">|</span> UPPER<span class="token punctuation">(</span>host<span class="token punctuation">)</span>    <span class="token operator">|</span>
<span class="token operator">|</span> 数学   <span class="token operator">|</span> <span class="token function">ROUND</span><span class="token punctuation">(</span>latency<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">ROUND</span><span class="token punctuation">(</span>latency<span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">|</span> 聚合   <span class="token operator">|</span> <span class="token function">SUM</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>     <span class="token operator">|</span> <span class="token function">SUM</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>     <span class="token operator">|</span>
</code></pre>
                                </div>
                            </div>

                <div class="sheet-section"  data-position="580|0|704">
                    <div class="section-title"><h3 id="id-8">9. 完整例子</h3></div>
                    <div class="section-body">
                        <p><em>SQL：</em></p>
<pre class="language-sql" tabindex="0"><code class="language-sql" style="font-size: 12px !important;"><span class="token keyword">SELECT</span> host<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> total<span class="token punctuation">,</span> <span class="token function">AVG</span><span class="token punctuation">(</span>latency<span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_latency
<span class="token keyword">FROM</span> logs
<span class="token keyword">WHERE</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token number">200</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> host
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> avg_latency <span class="token keyword">DESC</span>
<span class="token keyword">LIMIT</span> <span class="token number">5</span><span class="token punctuation">;</span>
</code></pre>
<p><em>ES|QL：</em></p>
<pre class="language-sql" tabindex="0"><code class="language-sql" style="font-size: 12px !important;"><span class="token keyword">FROM</span> logs
<span class="token operator">|</span> <span class="token keyword">WHERE</span> <span class="token keyword">status</span> <span class="token operator">=</span><span class="token operator">=</span> <span class="token number">200</span>
<span class="token operator">|</span> STATS total <span class="token operator">=</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span> avg_latency <span class="token operator">=</span> <span class="token function">AVG</span><span class="token punctuation">(</span>latency<span class="token punctuation">)</span> <span class="token keyword">BY</span> host
<span class="token operator">|</span> SORT avg_latency <span class="token keyword">DESC</span>
<span class="token operator">|</span> <span class="token keyword">LIMIT</span> <span class="token number">5</span>
</code></pre>
                    </div>
                </div>
                </div>
                
            </div>
            <div id="sheet-nav">
        <div class="nav-wrapper">
            <div class="nav-btn">
                <div class="nav-btn__item nav-btn-top">顶</div>
                <div class="nav-btn__item nav-btn-menu">菜</div>
            </div>
            <div class="nav-content hide">
                    <div class="nav-item nav-type-H3 " title="1. 数据源" data-id="id-0" data-pid="default">
                    <span class="next-ctrl"></span> 1. 数据源
                    </div>
                
                    <div class="nav-item nav-type-H3 " title="2. 条件过滤" data-id="id-1" data-pid="default">
                    <span class="next-ctrl"></span> 2. 条件过滤
                    </div>
                
                    <div class="nav-item nav-type-H3 " title="3. 字段选择" data-id="id-2" data-pid="default">
                    <span class="next-ctrl"></span> 3. 字段选择
                    </div>
                
                    <div class="nav-item nav-type-H3 " title="4. 计算字段" data-id="id-3" data-pid="default">
                    <span class="next-ctrl"></span> 4. 计算字段
                    </div>
                
                    <div class="nav-item nav-type-H3 " title="5. 聚合统计" data-id="id-4" data-pid="default">
                    <span class="next-ctrl"></span> 5. 聚合统计
                    </div>
                
                    <div class="nav-item nav-type-H3 " title="6. 排序 &amp; 限制" data-id="id-5" data-pid="default">
                    <span class="next-ctrl"></span> 6. 排序 &amp; 限制
                    </div>
                
                    <div class="nav-item nav-type-H3 " title="7. 时间函数" data-id="id-6" data-pid="default">
                    <span class="next-ctrl"></span> 7. 时间函数
                    </div>
                
                    <div class="nav-item nav-type-H3 " title="8. 常见函数" data-id="id-7" data-pid="default">
                    <span class="next-ctrl"></span> 8. 常见函数
                    </div>
                
                    <div class="nav-item nav-type-H3 " title="9. 完整例子" data-id="id-8" data-pid="default">
                    <span class="next-ctrl"></span> 9. 完整例子
                    </div>
                </div>
        </div>
        </div>
        </div></div>

    
    <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0200265368172615" crossorigin="anonymous"></script>



<script src="../js/util/function.js?version=1756629064754"></script><script src="../js/util/event-hub.js?version=1756629064754"></script><script src="../js/3rdparty/prism.js?version=1756629064754"></script><script src="../js/module/loading.js?version=1756629064754"></script><script src="../js/module/home.js?version=1756629064754"></script><script src="../js/module/cheatsheet.js?version=1756629064754"></script><script src="../js/module/menu.js?version=1756629064754"></script><script src="../js/3rdparty/jszip.min.js?version=1756629064754"></script><script src="../js/util/saveData.js?version=1756629064754"></script></body></html>